import matplotlib.pyplot as plt
import numpy as np

import fully_connected_feed_neuron_count as fc

# Create a vector to store all our batch sizes
# 100 is the default. We try that, half that, double that, min (1) and max (55000)
hidden_neurons = [16, 32, 64, 128, 256, 512, 1024]
hidden_neurons = [1024]
N = len(hidden_neurons)
time_to_ninety = np.empty([0,0])

M = (fc.FLAGS.max_steps-1)/200+1
    
time  = np.empty([0,M])
steps = np.empty([0,M])
train = np.empty([0,M])
val   = np.empty([0,M])
test  = np.empty([0,M])


for x in xrange(N):
    for y in xrange(N):
        
        print("beginning run #" + str(N*x+y) + ".")
        step_vec, time_vec, train_prec, val_prec, test_prec = fc.run_training(hidden_neurons[x],hidden_neurons[y])

        time = np.vstack((time,time_vec))
        train = np.vstack((train,train_prec))
        val = np.vstack((val,val_prec))
        test = np.vstack((test,test_prec))
        
        print("run #" + str(N*x+y) + " successful.")
        plt.subplot(N,N,N*x+y+1)
        plt.plot(step_vec, test_prec, label="h1="+str(hidden_neurons[x])+",h2="+str(hidden_neurons[y]))
        plt.legend(loc='lower right')
        plt.xlabel('Training Epoch')
        plt.xlabel('Percent Correct')
        plt.title("h1="+str(hidden_neurons[x])+",h2="+str(hidden_neurons[y]))
plt.show()
